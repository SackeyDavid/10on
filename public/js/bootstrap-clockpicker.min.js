!function(){function t(t){return document.createElementNS(h,t)}function i(t){return(10>t?"0":"")+t}function e(e,c){function n(t,i){var e=k.offset(),s=/^touch/.test(t.type),n=e.left+w,a=e.top+w,r=(s?t.originalEvent.touches[0]:t).pageX-n,p=(s?t.originalEvent.touches[0]:t).pageY-a,h=Math.sqrt(r*r+p*p),d=!1;if(!i||!(y-A>h||h>y+A)){t.preventDefault();var f=setTimeout(function(){o.addClass("clockpicker-moving")},200);u&&k.append(E.canvas),E.setHand(r,p,!i,!0),l.off(v).on(v,function(t){t.preventDefault();var i=/^touch/.test(t.type),e=(i?t.originalEvent.touches[0]:t).pageX-n,s=(i?t.originalEvent.touches[0]:t).pageY-a;(d||e!==r||s!==p)&&(d=!0,E.setHand(e,s,!1,!0))}),l.off(m).on(m,function(t){l.off(m),t.preventDefault();var e=/^touch/.test(t.type),s=(e?t.originalEvent.changedTouches[0]:t).pageX-n,h=(e?t.originalEvent.changedTouches[0]:t).pageY-a;(i||d)&&s===r&&h===p&&E.setHand(s,h),"hours"===E.currentView?E.toggleView("minutes",T/2):c.autoclose&&(E.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){E.done()},T/2)),k.prepend(U),clearTimeout(f),o.removeClass("clockpicker-moving"),l.off(v)})}}var a,p,h=r(C),k=h.find(".clockpicker-plate"),d=h.find(".clockpicker-hours"),b=h.find(".clockpicker-minutes"),H=h.find(".clockpicker-am-pm-block"),P="INPUT"===e.prop("tagName"),x=P?e:e.find("input"),S=e.find(".input-group-addon"),E=this;if(this.id=(p=++g+"",(a="cp")?a+p:p),this.element=e,this.options=c,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=P,this.input=x,this.addon=S,this.popover=h,this.plate=k,this.hoursView=d,this.minutesView=b,this.amPmBlock=H,this.spanHours=h.find(".clockpicker-span-hours"),this.spanMinutes=h.find(".clockpicker-span-minutes"),this.spanAmPm=h.find(".clockpicker-span-am-pm"),this.amOrPm="PM",c.twelvehour){var D=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-am-button">',"AM</button>",'<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-pm-button">',"PM</button>","</div>"].join("");r(D),r('<button type="button" class="btn btn-sm btn-default clockpicker-button am-button">AM</button>').on("click",function(){E.amOrPm="AM",r(".clockpicker-span-am-pm").empty().append("AM")}).appendTo(this.amPmBlock),r('<button type="button" class="btn btn-sm btn-default clockpicker-button pm-button">PM</button>').on("click",function(){E.amOrPm="PM",r(".clockpicker-span-am-pm").empty().append("PM")}).appendTo(this.amPmBlock)}c.autoclose||r('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+c.donetext+"</button>").click(r.proxy(this.done,this)).appendTo(h),"top"!==c.placement&&"bottom"!==c.placement||"top"!==c.align&&"bottom"!==c.align||(c.align="left"),"left"!==c.placement&&"right"!==c.placement||"left"!==c.align&&"right"!==c.align||(c.align="top"),h.addClass(c.placement),h.addClass("clockpicker-align-"+c.align),this.spanHours.click(r.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(r.proxy(this.toggleView,this,"minutes")),x.on("focus.clockpicker click.clockpicker",r.proxy(this.show,this)),S.on("click.clockpicker",r.proxy(this.toggle,this));var I,B,z,O,j=r('<div class="clockpicker-tick"></div>');if(c.twelvehour)for(I=1;13>I;I+=1)B=j.clone(),z=I/6*Math.PI,O=y,B.css("font-size","120%"),B.css({left:w+Math.sin(z)*O-A,top:w-Math.cos(z)*O-A}),B.html(0===I?"00":I),d.append(B),B.on(f,n);else for(I=0;24>I;I+=1){B=j.clone(),z=I/6*Math.PI;var L=I>0&&13>I;O=L?M:y,B.css({left:w+Math.sin(z)*O-A,top:w-Math.cos(z)*O-A}),L&&B.css("font-size","120%"),B.html(0===I?"00":I),d.append(B),B.on(f,n)}for(I=0;60>I;I+=5)B=j.clone(),z=I/30*Math.PI,B.css({left:w+Math.sin(z)*y-A,top:w-Math.cos(z)*y-A}),B.css("font-size","120%"),B.html(i(I)),b.append(B),B.on(f,n);if(k.on(f,function(t){0===r(t.target).closest(".clockpicker-tick").length&&n(t,!0)}),u){var U=h.find(".clockpicker-canvas"),W=t("svg");W.setAttribute("class","clockpicker-svg"),W.setAttribute("width",V),W.setAttribute("height",V);var N=t("g");N.setAttribute("transform","translate("+w+","+w+")");var X=t("circle");X.setAttribute("class","clockpicker-canvas-bearing"),X.setAttribute("cx",0),X.setAttribute("cy",0),X.setAttribute("r",2);var Y=t("line");Y.setAttribute("x1",0),Y.setAttribute("y1",0);var q=t("circle");q.setAttribute("class","clockpicker-canvas-bg"),q.setAttribute("r",A);var F=t("circle");F.setAttribute("class","clockpicker-canvas-fg"),F.setAttribute("r",3.5),N.appendChild(Y),N.appendChild(q),N.appendChild(F),N.appendChild(X),W.appendChild(N),U.append(W),this.hand=Y,this.bg=q,this.fg=F,this.bearing=X,this.g=N,this.canvas=U}s(this.options.init)}function s(t){t&&"function"==typeof t&&t()}var o,c,n,a,r=window.jQuery,p=r(window),l=r(document),h="http://www.w3.org/2000/svg",u="SVGAngle"in window&&((a=document.createElement("div")).innerHTML="<svg/>",n=(a.firstChild&&a.firstChild.namespaceURI)==h,a.innerHTML="",n),k="transition"in(c=document.createElement("div").style)||"WebkitTransition"in c||"MozTransition"in c||"msTransition"in c||"OTransition"in c,d="ontouchstart"in window,f="mousedown"+(d?" touchstart":""),v="mousemove.clockpicker"+(d?" touchmove.clockpicker":""),m="mouseup.clockpicker"+(d?" touchend.clockpicker":""),b=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,g=0,w=100,y=80,M=54,A=13,V=2*w,T=k?350:1,C=['<div class="popover clockpicker-popover">','<div class="arrow"></div>','<div class="popover-title">','<span class="clockpicker-span-hours text-primary"></span>'," : ",'<span class="clockpicker-span-minutes"></span>','<span class="clockpicker-span-am-pm"></span>',"</div>",'<div class="popover-content">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<span class="clockpicker-am-pm-block">',"</span>","</div>","</div>"].join("");e.DEFAULTS={default:"",fromnow:0,placement:"bottom",align:"left",donetext:"完成",autoclose:!1,twelvehour:!1,vibrate:!0},e.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},e.prototype.locate=function(){var t=this.element,i=this.popover,e=t.offset(),s=t.outerWidth(),o=t.outerHeight(),c=this.options.placement,n=this.options.align,a={};switch(i.show(),c){case"bottom":a.top=e.top+o;break;case"right":a.left=e.left+s;break;case"top":a.top=e.top-i.outerHeight();break;case"left":a.left=e.left-i.outerWidth()}switch(n){case"left":a.left=e.left;break;case"right":a.left=e.left+s-i.outerWidth();break;case"top":a.top=e.top;break;case"bottom":a.top=e.top+o-i.outerHeight()}i.css(a)},e.prototype.show=function(){if(!this.isShown){s(this.options.beforeShow);var t=this;this.isAppended||(o=r(document.body).append(this.popover),p.on("resize.clockpicker"+this.id,function(){t.isShown&&t.locate()}),this.isAppended=!0);var e=((this.input.prop("value")||this.options.default||"")+"").split(":");if("now"===e[0]){var c=new Date(+new Date+this.options.fromnow);e=[c.getHours(),c.getMinutes()]}this.hours=+e[0]||0,this.minutes=+e[1]||0,this.spanHours.html(i(this.hours)),this.spanMinutes.html(i(this.minutes)),this.toggleView("hours"),this.locate(),this.isShown=!0,l.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(i){var e=r(i.target);0===e.closest(t.popover).length&&0===e.closest(t.addon).length&&0===e.closest(t.input).length&&t.hide()}),l.on("keyup.clockpicker."+this.id,function(i){27===i.keyCode&&t.hide()}),s(this.options.afterShow)}},e.prototype.hide=function(){s(this.options.beforeHide),this.isShown=!1,l.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),l.off("keyup.clockpicker."+this.id),this.popover.hide(),s(this.options.afterHide)},e.prototype.toggleView=function(t,i){var e=!1;"minutes"===t&&"visible"===r(this.hoursView).css("visibility")&&(s(this.options.beforeHourSelect),e=!0);var o="hours"===t,c=o?this.hoursView:this.minutesView,n=o?this.minutesView:this.hoursView;this.currentView=t,this.spanHours.toggleClass("text-primary",o),this.spanMinutes.toggleClass("text-primary",!o),n.addClass("clockpicker-dial-out"),c.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){n.css("visibility","hidden")},T),e&&s(this.options.afterHourSelect)},e.prototype.resetClock=function(t){var i=this.currentView,e=this[i],s="hours"===i,o=e*(Math.PI/(s?6:30)),c=s&&e>0&&13>e?M:y,n=Math.sin(o)*c,a=-Math.cos(o)*c,r=this;u&&t?(r.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){r.canvas.removeClass("clockpicker-canvas-out"),r.setHand(n,a)},t)):this.setHand(n,a)},e.prototype.setHand=function(t,e,s,o){var c,n=Math.atan2(t,-e),a="hours"===this.currentView,p=Math.PI/(a||s?6:30),l=Math.sqrt(t*t+e*e),h=this.options,k=a&&(y+M)/2>l,d=k?M:y;if(h.twelvehour&&(d=y),0>n&&(n=2*Math.PI+n),n=(c=Math.round(n/p))*p,h.twelvehour?a?0===c&&(c=12):(s&&(c*=5),60===c&&(c=0)):a?(12===c&&(c=0),c=k?0===c?12:c:0===c?0:c+12):(s&&(c*=5),60===c&&(c=0)),this[this.currentView]!==c&&b&&this.options.vibrate&&(this.vibrateTimer||(navigator[b](10),this.vibrateTimer=setTimeout(r.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=c,this[a?"spanHours":"spanMinutes"].html(i(c)),u){o||!a&&c%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var f=Math.sin(n)*d,v=-Math.cos(n)*d;this.hand.setAttribute("x2",f),this.hand.setAttribute("y2",v),this.bg.setAttribute("cx",f),this.bg.setAttribute("cy",v),this.fg.setAttribute("cx",f),this.fg.setAttribute("cy",v)}else this[a?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var t=r(this);t.toggleClass("active",c===+t.html())})},e.prototype.done=function(){s(this.options.beforeDone),this.hide();var t=this.input.prop("value"),e=i(this.hours)+":"+i(this.minutes)+" ";this.options.twelvehour&&(e+=this.amOrPm),this.input.prop("value",e),e!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),s(this.options.afterDone)},e.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.addon.off("click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(p.off("resize.clockpicker"+this.id),this.popover.remove())},r.fn.clockpicker=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var s=r(this),o=s.data("clockpicker");if(o)"function"==typeof o[t]&&o[t].apply(o,i);else{var c=r.extend({},e.DEFAULTS,s.data(),"object"==typeof t&&t);s.data("clockpicker",new e(s,c))}})}}();